#' Dataset Object
#'
#' @details
#' Autogenerated via \code{\link[googleAuthR]{gar_create_api_objects}}
#' A workspace for solving a single, particular machine learning (ML) problem.A workspace contains examples that may be annotated.
#'
#' @param description User-provided description of the dataset
#' @param imageClassificationDatasetMetadata Metadata for a dataset used for image classification
#' @param etag Used to perform consistent read-modify-write updates
#' @param textSentimentDatasetMetadata Metadata for a dataset used for text sentiment
#' @param name Output only
#' @param imageObjectDetectionDatasetMetadata Metadata for a dataset used for image object detection
#' @param exampleCount Output only
#' @param translationDatasetMetadata Metadata for a dataset used for translation
#' @param displayName Required
#' @param textClassificationDatasetMetadata Metadata for a dataset used for text classification
#' @param createTime Output only
#' @param textExtractionDatasetMetadata Metadata for a dataset used for text extraction
#' @param videoClassificationDatasetMetadata Metadata for a dataset used for video classification
#' @param tablesDatasetMetadata Metadata for a dataset used for Tables
#'
#' @return Dataset object
#'
#' @family Dataset functions
#' @export
Dataset <- function(description = NULL,
                    imageClassificationDatasetMetadata = NULL,
                    etag = NULL,
                    textSentimentDatasetMetadata = NULL,
                    name = NULL,
                    imageObjectDetectionDatasetMetadata = NULL,
                    exampleCount = NULL,
                    translationDatasetMetadata = NULL,
                    displayName = NULL,
                    textClassificationDatasetMetadata = NULL,
                    createTime = NULL,
                    textExtractionDatasetMetadata = NULL,
                    videoClassificationDatasetMetadata = NULL,
                    tablesDatasetMetadata = NULL) {

  structure(list(description = description,
                 imageClassificationDatasetMetadata = imageClassificationDatasetMetadata,
                 etag = etag,
                 textSentimentDatasetMetadata = textSentimentDatasetMetadata,
                 name = name,
                 imageObjectDetectionDatasetMetadata = imageObjectDetectionDatasetMetadata,
                 exampleCount = exampleCount,
                 translationDatasetMetadata = translationDatasetMetadata,
                 displayName = displayName,
                 textClassificationDatasetMetadata = textClassificationDatasetMetadata,
                 createTime = createTime,
                 textExtractionDatasetMetadata = textExtractionDatasetMetadata,
                 videoClassificationDatasetMetadata = videoClassificationDatasetMetadata,
                 tablesDatasetMetadata = tablesDatasetMetadata)
            # ,
            # class = "gar_Dataset"
            )
}

#' TablesDatasetMetadata Object
#'
#' @details
#' Autogenerated via \code{\link[googleAuthR]{gar_create_api_objects}}
#' Metadata for a dataset used for AutoML Tables.
#'
#' @param TablesDatasetMetadata.targetColumnCorrelations The \link{TablesDatasetMetadata.targetColumnCorrelations} object or list of objects
#' @param statsUpdateTime The most recent timestamp when target_column_correlations field and all
#' @param targetColumnCorrelations Output only
#' @param weightColumnSpecId column_spec_id of the primary table's column that should be used as the
#' @param mlUseColumnSpecId column_spec_id of the primary table column which specifies a possible ML
#' @param primaryTableSpecId Output only
#' @param targetColumnSpecId column_spec_id of the primary table's column that should be used as the
#'
#' @return TablesDatasetMetadata object
#'
#' @family TablesDatasetMetadata functions
#' @export
TablesDatasetMetadata <- function(TablesDatasetMetadata.targetColumnCorrelations = NULL,
                                  statsUpdateTime = NULL,
                                  targetColumnCorrelations = NULL,
                                  weightColumnSpecId = NULL,
                                  mlUseColumnSpecId = NULL,
                                  primaryTableSpecId = NULL,
                                  targetColumnSpecId = NULL) {

  structure(list(TablesDatasetMetadata.targetColumnCorrelations = TablesDatasetMetadata.targetColumnCorrelations,
                 statsUpdateTime = statsUpdateTime,
                 targetColumnCorrelations = targetColumnCorrelations,
                 weightColumnSpecId = weightColumnSpecId,
                 mlUseColumnSpecId = mlUseColumnSpecId,
                 primaryTableSpecId = primaryTableSpecId,
                 targetColumnSpecId = targetColumnSpecId)
            # ,
            # class = "gar_TablesDatasetMetadata"
            )
}


#' Creates a dataset.
#'
#'
#' @param Dataset The \link{Dataset} object to pass to this method
#' @param parent The resource name of the project to create the dataset for
#' @importFrom googleAuthR gar_api_generator
#' @family Dataset functions
#' @export
gcat_create_dataset <- function(Dataset,
                                parent = gcat_location) {

  url <- sprintf("https://automl.googleapis.com/v1beta1/%s/datasets",
                 parent)

  # automl.projects.locations.datasets.create
  f <- googleAuthR::gar_api_generator(url,
                                      "POST",
                                      data_parse_function = function(x) x)

  # stopifnot(inherits(Dataset, "gar_Dataset"))
  # Dataset <- rmNullObs(Dataset)

  f(the_body = Dataset)

}
