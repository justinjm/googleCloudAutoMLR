#' Dataset Object
#'
#' @details
#' Autogenerated via \code{\link[googleAuthR]{gar_create_api_objects}}
#' A workspace for solving a single, particular machine learning (ML) problem.A workspace contains examples that may be annotated.
#'
#' @param name Output only
#' @param displayName Required
#' @param description User-provided description of the dataset
#' @param exampleCount Output only
#' @param createTime Output only
#' @param etag Used to perform consistent read-modify-write updates
#' @param tablesDatasetMetadata Metadata for a dataset used for Tables
#'
#' @return Dataset object
#'
#' @family Dataset functions
#' @export
Dataset <- function(name = NULL,
                    displayName = NULL,
                    description = NULL,
                    exampleCount = NULL,
                    createTime = NULL,
                    etag = NULL,
                    tablesDatasetMetadata = NULL) {

  structure(list(name = name,
                 displayName = displayName,
                 description = description,
                 exampleCount = exampleCount,
                 createTime = createTime,
                 etag = etag,
                 tablesDatasetMetadata = tablesDatasetMetadata)
            # ,
            # class = "gar_Dataset"
  )
}

#' TablesDatasetMetadata Object
#'
#' @details
#' Autogenerated via \code{\link[googleAuthR]{gar_create_api_objects}}
#' Metadata for a dataset used for AutoML Tables.
#'
#' @param statsUpdateTime The most recent timestamp when target_column_correlations field and all
#' @param targetColumnCorrelations Output only
#' @param weightColumnSpecId column_spec_id of the primary table's column that should be used as the
#' @param mlUseColumnSpecId column_spec_id of the primary table column which specifies a possible ML
#' @param primaryTableSpecId Output only
#' @param targetColumnSpecId column_spec_id of the primary table's column that should be used as the
#'
#' @return TablesDatasetMetadata object
#'
#' @family TablesDatasetMetadata functions
#' @export
TablesDatasetMetadata <- function(statsUpdateTime = NULL,
                                  targetColumnCorrelations = NULL,
                                  weightColumnSpecId = NULL,
                                  mlUseColumnSpecId = NULL,
                                  primaryTableSpecId = NULL,
                                  targetColumnSpecId = NULL) {

  structure(list(statsUpdateTime = statsUpdateTime,
                 targetColumnCorrelations = targetColumnCorrelations,
                 weightColumnSpecId = weightColumnSpecId,
                 mlUseColumnSpecId = mlUseColumnSpecId,
                 primaryTableSpecId = primaryTableSpecId,
                 targetColumnSpecId = targetColumnSpecId)
            # ,
            # class = "gar_TablesDatasetMetadata"
  )
}


#' Creates a dataset.
#'
#'
#' @param Dataset The \link{Dataset} object to pass to this method
#' @param parent The resource name of the project to create the dataset for
#' @importFrom googleAuthR gar_api_generator
#' @family Dataset functions
#' @export
gcat_create_dataset <- function(Dataset,
                                parent = gcat_location) {

  url <- sprintf("https://automl.googleapis.com/v1beta1/%s/datasets",
                 parent)

  # automl.projects.locations.datasets.create
  f <- googleAuthR::gar_api_generator(url,
                                      "POST",
                                      data_parse_function = function(x) x)

  # stopifnot(inherits(Dataset, "gar_Dataset"))
  # Dataset <- rmNullObs(Dataset)

  f(the_body = Dataset)

}
