#' Lists datasets in a project.
#'
#' @param projectId
#' @param location
#' @export
gcat_list_datasets <- function(projectId,
                               location) {

  location_path <- gcat_location_path(projectId, location)

  gcat_list_datasets_do_call(parent = location_path)

}

#' Lists datasets in a project. (internal API call)
#'
#' @param parent The resource name of the project from which to list datasets
#' @param filter An expression for filtering the results of the request
#' @param pageToken A token identifying a page of results for the server to return
#' @param pageSize Requested page size
#' @keywords internal
#' @noRd
gcat_list_datasets_do_call <- function(parent,
                                       filter = NULL,
                                       pageToken = NULL,
                                       pageSize = NULL) {

  url <- sprintf("https://automl.googleapis.com/v1beta1/%s/datasets",
                 parent)

  # automl.projects.locations.datasets.list
  pars = list(filter = filter,
              pageToken = pageToken,
              pageSize = pageSize)

  f <- googleAuthR::gar_api_generator(url,
                                      "GET",
                                      pars_args = rmNullObs(pars),
                                      data_parse_function = function(x) x)
  f()

}

#' Check if objecti is Dataset object
#'
# is.gcat_dataset <- function(x) inherits(x, "gar_Dataset")

#' Creates a dataset
#'
#' @param displayName
#' @param
#' @export
gcat_create_dataset <- function(projectId,
                                location,
                                displayName,
                                parent) {

  location_path <- gcat_location_path(projectId, location)

  ds <- structure(
    list(
      displayName = displayName,
      tablesDatasetMetadata = structure(
        list(),
        names=character(0)
      )
    ),
    class = c("gar_Dataset", "list")
  )

  gcat_create_dataset_do_call(Dataset = ds,
                              parent = location_path)

}

#' Creates a dataset (Internal API call).
#'
#' @param parent The resource name of the project to create the dataset for
#' @importFrom googleAuthR gar_api_generator
#' @family Dataset functions
#' @keywords internal
#' @noRd
gcat_create_dataset_do_call <- function(Dataset,
                                        parent) {

  url <- sprintf("https://automl.googleapis.com/v1beta1/%s/datasets",
                 parent)
  # automl.projects.locations.datasets.create
  f <- googleAuthR::gar_api_generator(url,
                                      "POST",
                                      data_parse_function = function(x) x,
                                      checkTrailingSlash = FALSE)
  stopifnot(inherits(Dataset, "gar_Dataset"))
  f(the_body = Dataset)

}

#' Dataset Object
#'
#' @details
#' Autogenerated via \code{\link[googleAuthR]{gar_create_api_objects}}
#' A workspace for solving a single, particular machine learning (ML) problem.A workspace contains examples that may be annotated.
#'
#' @param createTime Output only
#' @param textExtractionDatasetMetadata Metadata for a dataset used for text extraction
#' @param videoClassificationDatasetMetadata Metadata for a dataset used for video classification
#' @param tablesDatasetMetadata Metadata for a dataset used for Tables
#' @param description User-provided description of the dataset
#' @param imageClassificationDatasetMetadata Metadata for a dataset used for image classification
#' @param etag Used to perform consistent read-modify-write updates
#' @param textSentimentDatasetMetadata Metadata for a dataset used for text sentiment
#' @param name Output only
#' @param imageObjectDetectionDatasetMetadata Metadata for a dataset used for image object detection
#' @param translationDatasetMetadata Metadata for a dataset used for translation
#' @param exampleCount Output only
#' @param videoObjectTrackingDatasetMetadata Metadata for a dataset used for video object tracking
#' @param displayName Required
#' @param textClassificationDatasetMetadata Metadata for a dataset used for text classification
#'
#' @return Dataset object
#'
#' @family Dataset functions
#' @noRd
Dataset <- function(createTime = NULL, textExtractionDatasetMetadata = NULL, videoClassificationDatasetMetadata = NULL,
                    tablesDatasetMetadata = NULL, description = NULL, imageClassificationDatasetMetadata = NULL,
                    etag = NULL, textSentimentDatasetMetadata = NULL, name = NULL, imageObjectDetectionDatasetMetadata = NULL,
                    translationDatasetMetadata = NULL, exampleCount = NULL, videoObjectTrackingDatasetMetadata = NULL,
                    displayName = NULL, textClassificationDatasetMetadata = NULL) {
  structure(list(createTime = createTime, textExtractionDatasetMetadata = textExtractionDatasetMetadata,
                 videoClassificationDatasetMetadata = videoClassificationDatasetMetadata,
                 tablesDatasetMetadata = tablesDatasetMetadata, description = description,
                 imageClassificationDatasetMetadata = imageClassificationDatasetMetadata,
                 etag = etag, textSentimentDatasetMetadata = textSentimentDatasetMetadata,
                 name = name, imageObjectDetectionDatasetMetadata = imageObjectDetectionDatasetMetadata,
                 translationDatasetMetadata = translationDatasetMetadata, exampleCount = exampleCount,
                 videoObjectTrackingDatasetMetadata = videoObjectTrackingDatasetMetadata,
                 displayName = displayName, textClassificationDatasetMetadata = textClassificationDatasetMetadata),
            class = "gar_Dataset")
}


#' TablesDatasetMetadata Object
#'
#' @details
#' Autogenerated via \code{\link[googleAuthR]{gar_create_api_objects}}
#' Metadata for a dataset used for AutoML Tables.
#'
#' @param TablesDatasetMetadata.targetColumnCorrelations The \link{TablesDatasetMetadata.targetColumnCorrelations} object or list of objects
#' @param statsUpdateTime The most recent timestamp when target_column_correlations field and all
#' @param targetColumnCorrelations Output only
#' @param weightColumnSpecId column_spec_id of the primary table's column that should be used as the
#' @param mlUseColumnSpecId column_spec_id of the primary table column which specifies a possible ML
#' @param primaryTableSpecId Output only
#' @param targetColumnSpecId column_spec_id of the primary table's column that should be used as the
#'
#' @return TablesDatasetMetadata object
#'
#' @family TablesDatasetMetadata functions
#' @noRd
TablesDatasetMetadata <- function(TablesDatasetMetadata.targetColumnCorrelations = NULL,
                                  statsUpdateTime = NULL, targetColumnCorrelations = NULL, weightColumnSpecId = NULL,
                                  mlUseColumnSpecId = NULL, primaryTableSpecId = NULL, targetColumnSpecId = NULL) {
  structure(list(TablesDatasetMetadata.targetColumnCorrelations = TablesDatasetMetadata.targetColumnCorrelations,
                 statsUpdateTime = statsUpdateTime, targetColumnCorrelations = targetColumnCorrelations,
                 weightColumnSpecId = weightColumnSpecId, mlUseColumnSpecId = mlUseColumnSpecId,
                 primaryTableSpecId = primaryTableSpecId, targetColumnSpecId = targetColumnSpecId),
            class = "gar_TablesDatasetMetadata")
}

#' TablesDatasetMetadata.targetColumnCorrelations Object
#'
#' @details
#' Autogenerated via \code{\link[googleAuthR]{gar_create_api_objects}}
#' Output only. Correlations betweenTablesDatasetMetadata.target_column_spec_id,and other columns of theTablesDatasetMetadataprimary_table.Only set if the target column is set. Mapping from other column spec id toits CorrelationStats with the target column.This field may be stale, see the stats_update_time field forfor the timestamp at which these stats were last updated.
#'
#'
#'
#' @return TablesDatasetMetadata.targetColumnCorrelations object
#'
#' @family TablesDatasetMetadata functions
#' @noRd
TablesDatasetMetadata.targetColumnCorrelations <- function() {
  list()
}

#' Import data into AutoML Tables
#' https://cloud.google.com/automl-tables/docs/datasets#automl-tables-example-cli-curl
#' @returns inputConfig object
gcat_import_data <- function(projectId,
                             datasetName,
                             bucketName,
                             fileName) {

  idr <- structure(
    list(
      gcsSource = list(
        inputUris = ""
      )
    ),
    class = c("gar_ImportDataRequest", "list")
  )

  gcat_import_data_do_call(ImportDataRequest = idr,
                           name = )


}

#' Imports data into a dataset.For Tables this method can only be called on an empty Dataset.For Tables:*   Aschema_inference_version    parameter must be explicitly set.Returns an empty response in theresponse field when it completes.
#'
#' Autogenerated via \code{\link[googleAuthR]{gar_create_api_skeleton}}
#'
#' @seealso \href{https://cloud.google.com/automl}{Google Documentation}
#'
#' @details
#' Authentication scopes used by this function are:
#' \itemize{
#'   \item https://www.googleapis.com/auth/cloud-platform
#' }
#'
#' Set \code{options(googleAuthR.scopes.selected = c(https://www.googleapis.com/auth/cloud-platform)}
#' Then run \code{googleAuthR::gar_auth()} to authenticate.
#' See \code{\link[googleAuthR]{gar_auth}} for details.
#'
#' @param ImportDataRequest The \link{ImportDataRequest} object to pass to this method
#' @param name Required
#' @importFrom googleAuthR gar_api_generator
#' @family ImportDataRequest functions
#' @noRd
gcat_import_data_do_call <- function(ImportDataRequest,
                                     name) {
  url <- sprintf("https://automl.googleapis.com/v1beta1/{+name}:importData",
                 name)
  # automl.projects.locations.datasets.importData
  f <- googleAuthR::gar_api_generator(url,
                                      "POST",
                                      data_parse_function = function(x) x)
  stopifnot(inherits(ImportDataRequest, "gar_ImportDataRequest"))

  f(the_body = ImportDataRequest)

}

#' ImportDataRequest Object
#'
#' @details
#' Autogenerated via \code{\link[googleAuthR]{gar_create_api_objects}}
#' Request message for AutoMl.ImportData.
#'
#' @param inputConfig Required
#'
#' @return ImportDataRequest object
#'
#' @family ImportDataRequest functions
#' @noRd
ImportDataRequest <- function(inputConfig = NULL) {
  structure(list(inputConfig = inputConfig), class = "gar_ImportDataRequest")
}

